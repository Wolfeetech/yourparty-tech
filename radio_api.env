# ============================================================================
# RadioWorkspace Backend Configuration (Master Template)
# Deployment Target: LXC 211 (/opt/radio-api/.env)
# ============================================================================

# ----------------------------------------------------------------------------
# DATABASE
# ----------------------------------------------------------------------------
MONGODB_URI=mongodb://192.168.178.202:27017
MONGO_URL="mongodb://yourparty_api:ZWxJCrUc7Ibsc4k37AoTxbXjwARiKBwnVr6oWknHr4@192.168.178.202:27017/yourparty_radio"
DB_NAME=radio_ratings
MONGO_DB_NAME=radio_ratings

# ----------------------------------------------------------------------------
# AUTHENTICATION & SECURITY
# ----------------------------------------------------------------------------
AUTH_JWT_SECRET=yourparty-jwt-secret-2025-prod-32chars-secure-key-change-if-needed
AUTH_TOKEN_ISSUER=yourparty-radio
AUTH_ACCESS_EXPIRES_MIN=60
AUTH_REFRESH_EXPIRES_H=168
AUTH_ALLOW_REGISTRATION=false
AUTH_REFRESH_COOKIE_NAME=yourparty_refresh

# Admin token for migrations/bulk operations
MIGRATION_TOKEN=yourparty-migration-2025-secure-token

# Control token for AutoDJ skip operations
CONTROL_TOKEN=yourparty-control-2025-secure-token

# ----------------------------------------------------------------------------
# AZURACAST INTEGRATION
# ----------------------------------------------------------------------------
AZURACAST_URL=https://192.168.178.210
AZURACAST_API_KEY=853f23fac17275a4:c8132dce48e36cc02484dda07c378d75
AZURACAST_STATION_ID=1
AZURACAST_VERIFY_SSL=false
# AZURACAST_CA_BUNDLE=/path/to/ca-bundle.crt  # Optional: custom CA

# ----------------------------------------------------------------------------
# CORS & PUBLIC URLS
# ----------------------------------------------------------------------------
CORS_ALLOWED_ORIGINS=[" https://yourparty.tech, https://www.yourparty.tech, https://api.yourparty.tech, http://localhost:8000, http://127.0.0.1:8000]
# Alternative: CORS_ALLOWED_REGEX=https://([a-z0-9-]+\.)?yourparty\.tech

PUBLIC_API_BASE=https://api.yourparty.tech
PUBLIC_SITE_BASE=https://yourparty.tech
PUBLIC_STREAM_URL=https://radio.yourparty.tech/listen/radio.yourparty/radio.mp3

# ----------------------------------------------------------------------------
# AUTODJ & RATINGS
# ----------------------------------------------------------------------------
AUTODJ_SKIP_THRESHOLD=2.0
AUTODJ_MIN_VOTES=3
AUTODJ_SKIP_COOLDOWN=900

LOW_RATING_THRESHOLD=2.0
TOP_RATING_THRESHOLD=4.5

# ----------------------------------------------------------------------------
# RATINGS EXPORT
# ----------------------------------------------------------------------------
RATINGS_EXPORT_DIR=/opt/radio-api/exports
RATINGS_EXPORT_FALLBACK_DIR=/opt/radio-api/exports
RATINGS_EXPORT_INTERVAL=60

# Music Assistant (optional)
MUSIC_ASSISTANT_EXPORT_DIR=/mnt/music_hdd/.yourparty
MUSIC_ASSISTANT_EXPORT_FILENAME=music_assistant_ratings.json

# ----------------------------------------------------------------------------
# INGEST PIPELINE (Auto-Upload to AzuraCast)
# ----------------------------------------------------------------------------
INGEST_ENABLED=true
INGEST_INPUT_DIR=/mnt/music_hdd/input
INGEST_ARCHIVE_DIR=/mnt/music_hdd/archive
INGEST_SCAN_INTERVAL=300

# ----------------------------------------------------------------------------
# AUTO-PLAYLIST GENERATOR
# ----------------------------------------------------------------------------
AUTO_PLAYLIST_ENABLED=true
AUTO_PLAYLIST_INTERVAL=900
AUTO_PLAYLIST_NAME=YourParty Favorites
AUTO_PLAYLIST_MIN_RATING=4.5
AUTO_PLAYLIST_MIN_VOTES=10
AUTO_PLAYLIST_MAX_TRACKS=100
# AUTO_PLAYLIST_GENRE=Synth|Wave  # Optional: regex filter

# ----------------------------------------------------------------------------
# CLOSED-LOOP FEATURES (Advanced)
# ----------------------------------------------------------------------------
FEATURE_CLOSED_LOOP=false
FEATURE_AZURACAST_SYNC=false
FEATURE_VETO_SKIP=false
FEATURE_WEBHOOKS=false

# Veto/Skip thresholds (when FEATURE_VETO_SKIP=true)
VETO_THRESHOLD=5
VETO_WINDOW_SECONDS=120
VETO_MIN_RATING=3.5

# Sync retry parameters
SYNC_RETRY_COUNT=3
SYNC_RETRY_DELAY=2
SYNC_BATCH_SIZE=50

# ----------------------------------------------------------------------------
# METRICS & MONITORING
# ----------------------------------------------------------------------------
YOURPARTY_METRICS_POLL_INTERVAL=10
RATING_METRICS_INTERVAL=60

# ----------------------------------------------------------------------------
# SYSTEM
# ----------------------------------------------------------------------------
MUSIC_DIR=/mnt/music_hdd/azuracast
AUTH_BOOTSTRAP_USERS_FILE=/opt/radio-api/bootstrap-users.json
